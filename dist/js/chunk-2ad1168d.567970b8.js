(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ad1168d"],{"07c9":function(t,s,e){"use strict";e.r(s);var o=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"user_posts",class:{"user_posts--no_border_bottom":t.posts&&!t.posts.length}},[e("div",{staticClass:"user_posts__title"},[t._v("Публикации пользователя")]),t.posts?t.posts.length?e("scroll-load",{attrs:{loading:t.loadingPosts},on:{loadNext:t.loadNewPosts}},[t._l(t.posts,(function(s,o){return e("thread-post",{key:"thread-post-"+s.id,class:{"post--last":o===t.posts.length-1},attrs:{post:s,"show-thread":!0,"click-for-post":!0}})})),t.loadingPosts?t._l(t.nextPostsCount,(function(t){return e("thread-post-placeholder",{key:"thread-post-placeholder-"+t})})):t._e()],2):[t._v("Нет публикаций")]:[t.posts?t._e():e("thread-post-placeholder")]],2)},a=[],n=(e("4de4"),e("7db0"),e("caad"),e("d81d"),e("b0c0"),e("2532"),e("2909")),i=e("8674"),r=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"post",class:{"post--highlighted":t.highlight,"post--selected":t.selected},on:{mouseenter:function(s){t.hover=!0},mouseleave:function(s){t.hover=!1},click:t.goToPost}},[e("div",{staticClass:"post__quote",class:{"post__quote--show":t.showQuote&&t.allowQuote&&t.showReply&&t.$store.state.username},style:{left:t.quoteX+"px",top:t.quoteY+"px"},on:{mousedown:t.emitReply}},[e("font-awesome-icon",{staticClass:"post__quote__icon",attrs:{icon:["fa","quote-right"]}}),t._v(" Quote post ")],1),e("font-awesome-icon",{staticClass:"post__remove_icon",class:{"post__remove_icon--show":t.showSelect&&!t.post.removed},attrs:{icon:["fa","check"]},on:{click:function(s){return s.stopPropagation(),t.toggleSelected(s)}}}),e("modal-window",{on:{click:function(t){t.stopPropagation()}},model:{value:t.showShareModal,callback:function(s){t.showShareModal=s},expression:"showShareModal"}},[e("div",{attrs:{slot:"main"},slot:"main"},[e("p",[t._v("Copy this URL to share the post")]),e("fancy-input",{attrs:{placeholder:"Post URL",value:t.postURL,width:"100%"}})],1),e("button",{staticClass:"button button--modal",attrs:{slot:"footer"},on:{click:function(s){return s.stopPropagation(),t.setShareModalState(!1)}},slot:"footer"},[t._v("OK")])]),e("report-post-modal",{attrs:{"post-id":t.post.id},model:{value:t.showReportPostModal,callback:function(s){t.showReportPostModal=s},expression:"showReportPostModal"}}),e("div",{staticClass:"post__meta_data"},[e("div",{staticStyle:{display:"inline-flex"}},[e("avatar-icon",{staticClass:"post__avatar",attrs:{user:t.post.User}}),t.showThread?e("div",{staticClass:"post__thread",on:{click:function(s){return s.stopPropagation(),t.goToThread(s)}}},[t._v(" In thread "),e("span",{staticClass:"post__thread__name"},[t._v(t._s(t._f("truncateMid")(t.post.Thread.name,50)))]),t._v(" · ")]):e("div",{staticClass:"post__user"},[t._v(" "+t._s(t.username)+" "),t.post.User&&t.post.User.admin?e("span",{staticClass:"admin_badge"},[t._v("admin")]):t._e()]),t.post.replyingToUsername?e("replying-to",{staticStyle:{"margin-right":"0.5rem"},attrs:{replyId:t.post.replyId,username:t.post.replyingToUsername},on:{click:function(s){return t.$emit("goToPost",t.post.replyId,!0)}}}):t._e()],1),e("div",{staticClass:"post__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"time|date",", ")))])]),e("div",{staticClass:"post__date post__date--mobile"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"time|date",", ")))]),e("div",{staticClass:"post__content",attrs:{tabindex:"-1"},domProps:{innerHTML:t._s(t.postContentHTML)},on:{mouseup:t.setShowQuote,blur:function(s){t.showQuote=!1}}}),e("div",{staticClass:"post__footer"},[e("div",{staticClass:"post__footer_group"},[e("div",{staticClass:"post__footer_sub_group"},[t.showReply?e("heart-button",{attrs:{post:t.post}}):t._e()],1),t.post.Replies.length?e("div",{staticClass:"post__footer_sub_group"},[e("span",{staticClass:"post__footer_sub_group__text post__footer_sub_group__text--replies"},[t._v("replies")]),t._l(t.post.Replies,(function(s,o){return e("post-reply",{key:"post-reply-"+s.postNumber,attrs:{post:s,hover:t.hover,first:0===o},on:{click:function(e){return t.$emit("goToPost",s.postNumber)}}})}))],2):t._e()]),t.post.removed?t._e():e("div",{staticClass:"post__footer_group post__actions",class:{"post__actions--show":t.showActions}},[e("div",{staticClass:"post__action post__share",on:{click:function(s){return s.stopPropagation(),t.setShareModalState(!0)}}},[t._v("share")]),t.$store.state.username?e("div",{staticClass:"post__action",on:{click:function(s){return s.stopPropagation(),t.setShowReportPostModal(!0)}}},[t._v(" report ")]):t._e(),t.$store.state.username&&t.showReply?e("div",{staticClass:"post__action post__reply",on:{click:function(s){return s.stopPropagation(),t.$emit("reply",t.post.id,t.username)}}},[t._v(" reply ")]):t._e()])]),e("div",{staticClass:"post__replies"})],1)},l=[],c=(e("99af"),e("0d03"),e("d3b7"),e("ac1f"),e("25f0"),e("5319"),function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("info-tooltip",{staticClass:"post_reply",class:{"post_reply--hover":t.hover,"post_reply--first":t.first}},[e("template",{slot:"content"},[e("div",{staticStyle:{"margin-top":"-0.25rem"}},[e("div",{staticClass:"post_reply__username"},[t._v(t._s(t.user.username))]),e("div",{staticClass:"post_reply__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"date|time"," - ")))])]),e("div",{staticClass:"post_reply__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),100)))])]),e("div",{staticClass:"post_reply__display",attrs:{slot:"display"},on:{click:function(s){return s.stopPropagation(),t.$emit("click")}},slot:"display"},[e("div",{staticClass:"post_reply__letter",style:{"background-color":t.user.color}},[t._v(" "+t._s(t.user.letter)+" ")])])],2)}),u=[],d=e("44ea"),p={name:"PostReply",props:["post","hover","first"],components:{InfoTooltip:d["a"]},computed:{user:function(){return this.post.User?Object.assign({letter:this.post.User.username[0]},this.post.User):{letter:" ",color:null,username:"[deleted]"}}}},_=p,h=(e("dd92"),e("2877")),m=Object(h["a"])(_,c,u,!1,null,null,null),f=m.exports,v=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"heart_button"},[e("modal-window",{attrs:{"close-button":!0,"hide-footer":!0,"no-padding":!0},model:{value:t.showModal,callback:function(s){t.showModal=s},expression:"showModal"}},[e("div",{staticClass:"heart_button__modal",attrs:{slot:"main"},slot:"main"},[e("div",{staticClass:"heart_button__modal__header"},[t._v("Likes")]),t._l(t.likes,(function(s){return e("div",{key:"heart-user-"+s.id,staticClass:"heart_button__modal__user",on:{click:function(e){return t.$router.push("/user/"+s.username)}}},[e("avatar-icon",{attrs:{user:s,size:"small"}}),e("div",{staticClass:"heart_button__modal__username"},[t._v(t._s(s.username))])],1)})),t.likes.length?t._e():e("div",{staticClass:"heart_button__modal__empty"},[t._v(" No likes ")])],2)]),e("font-awesome-icon",{staticClass:"heart_button__heart",class:{"heart_button__heart--unlikeable":!t.likeable,"heart_button__heart--liked":t.liked},attrs:{icon:["fa","heart"]},on:{click:t.changeLike}}),e("span",{staticClass:"heart_button__count",on:{click:function(s){t.showModal=!0}}},[t._v(t._s(t.likes.length))])],1)},g=[],b=(e("45fc"),e("a434"),e("6307")),w=e("9098"),C=e("c4b0"),y=e.n(C),k=e("2fa3"),P={name:"HeartButton",props:["post"],components:{ModalWindow:b["a"],AvatarIcon:w["a"]},data:function(){return{likes:this.post.Likes,showModal:!1}},computed:{likeable:function(){var t=this.post.User?this.post.User.username:null;return this.$store.state.username&&t!==this.$store.state.username},liked:function(){var t=this;return this.likes.some((function(s){return s.username===t.$store.state.username}))}},methods:{getIndexOfUser:function(){for(var t,s=0;s<this.likes.length;s++){var e=this.likes[s];if(e.username===this.$store.state.username){t=s;break}}return t},changeLike:function(){var t=this,s=this.post.id;this.likeable&&(this.liked?this.axios["delete"](k["a"]+"/api/v1/post/"+s+"/like").then((function(){t.likes.splice(t.getIndexOfUser(),1)}))["catch"](y()(this.$store)):this.axios.put(k["a"]+"/api/v1/post/"+s+"/like").then((function(){return t.axios.get(k["a"]+"/api/v1/user/"+t.$store.state.username)})).then((function(s){t.likes.push(s.data)}))["catch"](y()(this.$store)))}}},x=P,M=(e("6c02"),Object(h["a"])(x,v,g,!1,null,"004c0cbb",null)),$=M.exports,R=e("80e3"),S=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("info-tooltip",{staticClass:"replying_to",on:{hover:t.loadPost}},[e("template",{slot:"content"},[e("div",{staticStyle:{"margin-top":"-0.25rem"}},[t.post?e("div",{staticClass:"replying_to__username"},[t._v(t._s(t.postUsername))]):t._e(),t.post?e("div",{staticClass:"replying_to__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"date|time"," - ")))]):t._e()]),t.post?e("div",{staticClass:"replying_to__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),100)))]):[t._v("Loading...")]],2),e("div",{staticClass:"replying_to__display",attrs:{slot:"display"},on:{click:function(s){return s.stopPropagation(),t.$emit("click")}},slot:"display"},[e("font-awesome-icon",{staticClass:"replying_to__icon",attrs:{icon:["fa","reply"]}}),t._v(" "+t._s(t.username||"[deleted]")+" ")],1)],2)},T=[],O={name:"ReplyingTo",props:["replyId","username"],components:{InfoTooltip:d["a"]},data:function(){return{post:null}},computed:{postUsername:function(){return this.post.User?this.post.User.username:"[deleted]"}},methods:{loadPost:function(){var t=this;this.post||this.axios.get(k["a"]+"/api/v1/post/"+this.replyId).then((function(s){t.post=s.data}))["catch"](y()(this.$store))}}},U=O,I=(e("acf9"),Object(h["a"])(U,S,T,!1,null,null,null)),L=I.exports,q=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"report_post_modal"},[e("modal-window",{attrs:{loading:t.loading},model:{value:t.showModal,callback:function(s){t.showModal=s},expression:"showModal"}},[e("div",{staticClass:"report_post_modal__modal",attrs:{slot:"main"},slot:"main"},[e("h3",[t._v("Report this post")]),e("div",{staticClass:"report_post_modal--margin"},[t._v("Select a reason for reporting this post below:")]),e("select-button",{staticClass:"report_post_modal--margin",attrs:{options:t.reportOptions,"touch-disabled":!0},model:{value:t.selectedOption,callback:function(s){t.selectedOption=s},expression:"selectedOption"}})],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("button",{staticClass:"button button--modal",on:{click:function(s){return s.stopPropagation(),t.submitReport(s)}}},[t._v("Submit")]),e("button",{staticClass:"button button--modal",on:{click:function(s){return s.stopPropagation(),t.setShowModal(!1)}}},[t._v("Cancel")])])])],1)},E=[],j=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("menu-tooltip",{staticClass:"select_button",class:{"select_button--touch":!t.touchDisabled},model:{value:t.menuOpen,callback:function(s){t.menuOpen=s},expression:"menuOpen"}},[e("template",{slot:"button"},[t.options.length?e("div",{staticClass:"button button--thin_text",class:{"select_button__button--selected":t.menuOpen},on:{click:function(s){t.menuOpen=!0}}},[t._v(" "+t._s(t.options[t.selectedIndex].name)+" "),e("font-awesome-icon",{staticClass:"button__icon select_button__icon",attrs:{icon:["fa","chevron-down"],"fixed-width":""}})],1):e("div",{staticClass:"button"},[t._v(" No options ")])]),e("template",{slot:"menu"},t._l(t.options,(function(s,o){return e("div",{key:"select-button-option-"+s.name+o,staticClass:"select_button__option",class:{"select_button__option--disabled":s.disabled,"select_button__option--selected":o===t.selectedIndex&&!s.disabled},on:{click:function(e){return t.select(o,s.disabled)}}},[t._v(" "+t._s(s.name)+" ")])})),0)],2)},A=[],Q=(e("4160"),e("159b"),e("6fab")),N={name:"SelectButton",props:["options","value","name","touch-disabled"],components:{MenuTooltip:Q["a"]},methods:{select:function(t,s){s||(this.selectedIndex=t,this.menuOpen=!1,this.$emit("input",this.options[t].value))},getIndexFromValue:function(){var t=0,s=this;return null!==this.value&&this.options.forEach((function(e,o){e.value===s.value&&(t=o)})),t}},data:function(){return{selectedIndex:this.getIndexFromValue(),menuOpen:!1}},watch:{value:function(){this.selectedIndex=this.getIndexFromValue()}}},B=N,F=(e("2341"),Object(h["a"])(B,j,A,!1,null,"5c300c04",null)),H=F.exports,D={name:"ReportPostModal",props:["value","post-id"],components:{ModalWindow:b["a"],SelectButton:H},data:function(){return{showModal:!1,loading:!1,selectedOption:0,reportOptions:[{name:"Reason for reporting",disabled:!0},{name:"Spam",value:"spam"},{name:"Inappropriate content",value:"inappropriate"},{name:"Harassment",value:"harassment"}]}},methods:{setShowModal:function(t){this.showModal=t},submitReport:function(){var t=this;this.selectedOption&&(this.loading=!0,this.axios.post(k["a"]+"/api/v1/report",{postId:this.postId,reason:this.selectedOption}).then((function(){t.setShowModal(!1),t.selectedOption=0,t.loading=!1}))["catch"]((function(s){t.loading=!1,y()(t.$store)(s)})))}},watch:{value:function(t){this.showModal=t,this.$emit("input",t)},showModal:function(t){this.$emit("input",t)}}},W=D,V=(e("22a4"),Object(h["a"])(W,q,E,!1,null,"76edd028",null)),X=V.exports,Y={name:"ThreadPost",props:["post","highlight","showReply","showThread","showSelect","clickForPost","allowQuote"],components:{PostReply:f,ModalWindow:b["a"],FancyInput:R["a"],ReplyingTo:L,AvatarIcon:w["a"],HeartButton:$,ReportPostModal:X},data:function(){var t=this.post;return{hover:!1,showShareModal:!1,showReportPostModal:!1,postURL:"".concat(location.origin,"/p/").concat(t.id),selected:!1,showQuote:!1,quoteX:0,quoteY:0,quoteSelection:"",postContentHTML:t.content}},computed:{username:function(){return this.post.User?this.post.User.username:"[deleted]"},showActions:function(){return this.hover||this.showShareModal||this.showReportPostModal}},methods:{emitReply:function(){this.showQuote=!1,this.$emit("reply",this.post.id,this.username,this.quoteSelection)},setShowQuote:function(){var t=this.$el.getBoundingClientRect(),s=window.getSelection(),e=s.getRangeAt(0).getBoundingClientRect(),o=s.toString();o.length?(this.quoteY=e.top-t.top-30,this.quoteX=e.left-t.left,this.quoteSelection="> "+o.replace(/\n/g,"\n> ")+"\n\n",this.showQuote=!0):this.showQuote=!1},setShareModalState:function(t){this.showShareModal=t},setShowReportPostModal:function(t){this.showReportPostModal=t},goToThread:function(){this.$router.push("/thread/".concat(this.post.Thread.slug,"/").concat(this.post.Thread.id))},goToPost:function(){this.clickForPost&&this.$router.push("/thread/"+this.post.Thread.slug+"/"+this.post.Thread.id+"/"+this.post.postNumber)},toggleSelected:function(){this.selected=!this.selected,this.$emit("selected",this.post.id)}},watch:{showSelect:function(){this.selected&&this.$emit("selected",this.post.id),this.selected=!1}},mounted:function(){var t=this;this.$linkExpander(this.post.content,(function(s){return t.postContentHTML=s}))}},J=Y,z=(e("ba57"),Object(h["a"])(J,r,l,!1,null,"06e0255c",null)),K=z.exports,G=function(){var t=this,s=t.$createElement;t._self._c;return t._m(0)},Z=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"post_placeholder"},[e("div",{staticClass:"post_placeholder__meta_data"},[e("div",{staticClass:"post_placeholder__avatar_icon"}),e("div",{staticClass:"post_placeholder__bar post_placeholder__bar--thin post_placeholder__bar--33"})]),e("div",{staticClass:"post_placeholder__content"},[e("div",{staticClass:"post_placeholder__bar post_placeholder__bar--58"}),e("div",{staticClass:"post_placeholder__bar post_placeholder__bar--66"}),e("div",{staticClass:"post_placeholder__bar post_placeholder__bar--50"})])])}],tt={name:"ThreadPostPlaceholder"},st=tt,et=(e("4273"),Object(h["a"])(st,G,Z,!1,null,"6505f411",null)),ot=et.exports,at=e("bd28"),nt={name:"user",props:["username"],components:{ThreadPost:K,ScrollLoad:i["a"],ThreadPostPlaceholder:ot},data:function(){return{posts:null,loadingPosts:!1,nextPostsCount:0,nextURL:""}},methods:{loadNewPosts:function(){var t=this;null!==this.nextURL&&(this.loadingPosts=!0,this.axios.get(this.nextURL).then((function(s){var e;t.loadingPosts=!1,t.posts||(t.posts=[]);var o=t.posts.map((function(t){return t.id})),a=s.data.Posts.filter((function(t){return!o.includes(t.id)}));(e=t.posts).push.apply(e,Object(n["a"])(a)),t.nextURL=s.data.meta.nextURL,t.nextPostsCount=s.data.meta.nextPostsCount}))["catch"]((function(s){t.loadingPosts=!1,y()(t.$store)(s)})))}},created:function(){var t=this;this.$store.dispatch("setTitle",this.$route.params.username+" | посты"),this.axios.get(k["a"]+"/api/v1/user/".concat(this.$route.params.username,"?posts=true")).then((function(s){t.posts=s.data.Posts,t.nextURL=s.data.meta.nextURL,t.nextPostsCount=s.data.meta.nextPostsCount}))["catch"]((function(s){var e=s.response.data.errors.find((function(t){return"accountDoesNotExist"===t.name}));e?t.$store.commit("set404Page",!0):y()(t.$store)(s)})),Object(at["a"])("userPosts",this.$route.params.username)}},it=nt,rt=(e("a961"),Object(h["a"])(it,o,a,!1,null,"1dec8758",null));s["default"]=rt.exports},"0a6c":function(t,s,e){},"138c":function(t,s,e){},"22a4":function(t,s,e){"use strict";var o=e("98e5"),a=e.n(o);a.a},2341:function(t,s,e){"use strict";var o=e("0a6c"),a=e.n(o);a.a},4273:function(t,s,e){"use strict";var o=e("8bc6"),a=e.n(o);a.a},"45fc":function(t,s,e){"use strict";var o=e("23e7"),a=e("b727").some,n=e("a640"),i=e("ae40"),r=n("some"),l=i("some");o({target:"Array",proto:!0,forced:!r||!l},{some:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},"4b93":function(t,s,e){},"4ef1":function(t,s,e){},"5c93":function(t,s,e){},6307:function(t,s,e){"use strict";var o=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"modal_window__overlay",class:{"modal_window--show":t.value},on:{click:function(s){return s.target!==s.currentTarget?null:t.closeModal(s)}}},[e("div",{staticClass:"modal_window",class:{"modal_window--show":t.value},style:{width:t.width||"20rem"}},[e("div",{staticClass:"modal_window__loading_overlay",class:{"modal_window__loading_overlay--show":t.loading}},[e("loading-icon")],1),t.closeButton?e("span",{staticClass:"modal_window__close",on:{click:t.closeModal}},[e("font-awesome-icon",{attrs:{icon:["fa","times"]}})],1):t._e(),e("div",{staticClass:"modal_window__main",class:{"modal_window__main--no_padding":t.noPadding}},[t._t("main")],2),t.hideFooter?t._e():e("div",{staticClass:"modal_window__footer"},[t._t("footer")],2)])])},a=[],n=e("c5af"),i={name:"ModalWindow",props:["value","width","close-button","hide-footer","no-padding","loading"],components:{LoadingIcon:n["a"]},methods:{closeModal:function(){this.$emit("input",!1)}}},r=i,l=(e("f83a"),e("2877")),c=Object(l["a"])(r,o,a,!1,null,"32ecccd0",null);s["a"]=c.exports},"6c02":function(t,s,e){"use strict";var o=e("4b93"),a=e.n(o);a.a},"7db0":function(t,s,e){"use strict";var o=e("23e7"),a=e("b727").find,n=e("44d2"),i=e("ae40"),r="find",l=!0,c=i(r);r in[]&&Array(1)[r]((function(){l=!1})),o({target:"Array",proto:!0,forced:l||!c},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),n(r)},"8bc6":function(t,s,e){},"98e5":function(t,s,e){},a961:function(t,s,e){"use strict";var o=e("f1d2"),a=e.n(o);a.a},acf9:function(t,s,e){"use strict";var o=e("4ef1"),a=e.n(o);a.a},b9dc:function(t,s,e){},ba57:function(t,s,e){"use strict";var o=e("5c93"),a=e.n(o);a.a},bd28:function(t,s,e){"use strict";var o=e("bc3a"),a=e.n(o);s["a"]=function(t,s){"userPosts"===t||"userThreads"===t?a.a.get("/api/v1/user/"+s).then((function(s){return a.a.post("/api/v1/log",{route:t,resourceId:s.data.id})})):a.a.post("/api/v1/log",{route:t,resourceId:s})}},dd92:function(t,s,e){"use strict";var o=e("138c"),a=e.n(o);a.a},f1d2:function(t,s,e){},f83a:function(t,s,e){"use strict";var o=e("b9dc"),a=e.n(o);a.a}}]);
//# sourceMappingURL=chunk-2ad1168d.567970b8.js.map