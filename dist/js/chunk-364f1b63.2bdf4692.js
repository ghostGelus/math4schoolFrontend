(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-364f1b63"],{"5da9":function(t,o,s){},6319:function(t,o,s){},"70b1":function(t,o,s){"use strict";var n=s("6319"),e=s.n(n);e.a},d580:function(t,o,s){"use strict";s.r(o);var n=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",[s("admin-nav"),s("div",{staticClass:"admin"},[s("div",{staticClass:"admin__menu"},t._l(t.routes,(function(o){return s("div",{key:o.path,staticClass:"admin__menu__item",class:{"admin__menu__item--selected":o.route.includes(t.selected)},on:{click:function(s){return t.$router.push("/admin/"+o.route)}}},[s("div",[s("font-awesome-icon",{staticClass:"admin__menu__item__icon",attrs:{icon:["fa",o.icon]}})],1),s("div",[s("div",{staticClass:"admin__menu__item__title"},[t._v(" "+t._s(o.title)+" ")]),s("div",{staticClass:"admin__menu__item__description"},[t._v(" "+t._s(o.description)+" ")])])])})),0),s("router-view",{staticClass:"admin__router_view"})],1)],1)},e=[],a=(s("ac1f"),s("1276"),function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",{attrs:{id:"admin"}},[s("modal-window",{staticStyle:{"z-index":"100"},attrs:{width:"25rem","no-padding":!0},model:{value:t.showAjaxErrorsModal,callback:function(o){t.showAjaxErrorsModal=o},expression:"showAjaxErrorsModal"}},[s("div",{attrs:{slot:"main"},slot:"main"},t._l(this.$store.state.ajaxErrors,(function(o){return s("p",{key:o,staticStyle:{margin:"1rem"}},[t._v(" "+t._s(o)+" ")])})),0),s("button",{ref:"ajaxErrorsModalButton",staticClass:"button button--modal",attrs:{slot:"footer"},on:{click:function(o){t.showAjaxErrorsModal=!1}},slot:"footer"},[t._v(" OK ")])]),s("modal-window",{attrs:{"no-padding":!0,"hide-footer":!0},on:{input:t.closeAccountModal},model:{value:t.showAccountModal,callback:function(o){t.showAccountModal=o},expression:"showAccountModal"}},[s("tab-view",{attrs:{slot:"main",tabs:["Авторизация"],padding:"true"},slot:"main",model:{value:t.showAccountTab,callback:function(o){t.showAccountTab=o},expression:"showAccountTab"}},[s("template",{slot:"Авторизация"},[s("p",{staticStyle:{"margin-top":"0"}}),s("form",{on:{submit:function(o){return o.preventDefault(),t.doLogin(o)}}},[s("fancy-input",{attrs:{error:t.login.errors.username,placeholder:"Логин",width:"100%"},model:{value:t.login.username,callback:function(o){t.$set(t.login,"username",o)},expression:"login.username"}}),s("fancy-input",{attrs:{error:t.login.errors.hash,placeholder:"Пароль",type:"password",width:"100%"},model:{value:t.login.password,callback:function(o){t.$set(t.login,"password",o)},expression:"login.password"}}),s("div",{staticStyle:{"margin-top":"0.5rem"}},[s("loading-button",{staticClass:"button button--green button--margin",attrs:{loading:t.login.loading},on:{click:t.doLogin}},[s("font-awesome-icon",{staticStyle:{"margin-right":"0.25rem"},attrs:{icon:["fa","unlock-alt"]}}),t._v(" Войти ")],1),s("div",{staticClass:"button button--borderless",on:{click:t.closeAccountModal}},[t._v(" Отмена ")])],1)],1)])],2)],1),s("header",{staticClass:"header"},[s("div",{staticClass:"header__group"},[s("router-link",{staticClass:"logo",attrs:{to:"/"}})],1),s("div",{staticClass:"header__group",class:{"header__group--show":t.showMenu}},[t.$store.state.username?[t.$store.state.admin?s("router-link",{staticClass:"button button--thin_text",attrs:{to:"/admin"}},[t._v(" Панель администратора ")]):t._e(),s("loading-button",{staticClass:"button--thin_text",attrs:{loading:t.loadingLogout},on:{click:t.logout}},[t._v(" Выход ")])]:[s("div",{staticClass:"button button--thin_text",on:{click:function(o){return t.showAccountModalTab(0)}}},[t._v(" Login ")])]],2),s("div",{staticClass:"header__overlay",class:{"header__overlay--show":t.showMenu},on:{click:t.toggleMenu}}),s("span",{staticClass:"header__menu_button",on:{click:t.toggleMenu}},[s("font-awesome-icon",{attrs:{icon:["fa","bars"]}})],1)]),s("not-found",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.show404Page,expression:"$store.state.show404Page"}]})],1)}),i=[],r=(s("7db0"),s("b0c0"),s("498a"),s("6307")),c=s("80e3"),u=s("6334"),l=s("8e8d"),d=s("1b9a"),h=s("c4b0"),m=s.n(h),g={name:"app",components:{ModalWindow:r["a"],TabView:u["a"],FancyInput:c["a"],LoadingButton:l["a"],NotFound:d["a"]},data:function(){return{signup:{username:"",password:"",confirmPassword:"",loading:!1,errors:{username:"",hash:"",confirmPassword:""}},login:{username:"",password:"",loading:!1,errors:{username:"",hash:""}},loadingLogout:!1,showMenu:!0,ajaxErrorHandler:m()(this.$store)}},computed:{name:function(){return this.$store.state.meta.name},showAccountModal:{get:function(){return this.$store.state.accountModal},set:function(t){this.$store.commit("setAccountModalState",t)}},showAjaxErrorsModal:{get:function(){return this.$store.state.ajaxErrorsModal},set:function(t){this.$store.commit("setAjaxErrorsModalState",t)}},showAccountTab:{get:function(){return this.$store.state.accountTabs},set:function(t){this.$store.commit("setAccountTabs",t)}},categories:function(){return this.$store.state.meta.categories}},methods:{showAccountModalTab:function(t){this.toggleMenu(),this.showAccountModal=!0,this.showAccountTab=t},toggleMenu:function(){this.showMenu=!this.showMenu},logout:function(){var t=this;this.toggleMenu(),this.loadingLogout=!0,this.axios.post("/api/v1/user/"+this.$store.state.username+"/logout").then((function(o){t.loadingLogout=!1,t.$store.commit("setUsername",""),t.$store.commit("setAdmin",o.data.admin),t.$socket.emit("accountEvent"),t.$router.push("/")}))["catch"]((function(o){t.loadingLogout=!1,t.ajaxErrorHandler(o)}))},clearSignup:function(){this.signup.username="",this.signup.password="",this.signup.confirmPassword="",this.$store.commit("setToken",null)},clearSignupErrors:function(){this.signup.errors.username="",this.signup.errors.hash="",this.signup.errors.confirmPassword=""},clearLogin:function(){this.login.username="",this.login.password=""},clearLoginErrors:function(){this.login.errors.username="",this.login.errors.hash=""},closeAccountModal:function(){this.showAccountModal=!1,this.clearLogin(),this.clearSignup(),this.clearLoginErrors(),this.clearSignupErrors()},createAccount:function(){var t=this;this.clearSignupErrors();var o={username:this.signup.username,password:this.signup.password};this.$store.state.token&&(o.admin=!0,o.token=this.$store.state.token),this.signup.password!==this.signup.confirmPassword?this.signup.errors.confirmPassword="Passwords must match":(this.signup.loading=!0,this.axios.post("/api/v1/user",o).then((function(o){t.signup.loading=!1,t.$store.commit("setUsername",o.data.username),t.$store.commit("setAdmin",o.data.admin),t.closeAccountModal(),t.$socket.emit("accountEvent")}))["catch"]((function(o){t.signup.loading=!1,t.ajaxErrorHandler(o,(function(o){var s=o.path;void 0!==t.signup.errors[s]&&void 0!==t.signup.errors[s]&&(t.signup.errors[s]=o.message)}))})))},doLogin:function(){var t=this;this.clearSignupErrors(),this.login.username.trim().length?(this.login.loading=!0,this.axios.post("/api/v1/user/".concat(this.login.username,"/login"),{password:this.login.password}).then((function(o){t.login.loading=!1,t.$store.commit("setUsername",o.data.username),t.$store.commit("setAdmin",o.data.admin),t.closeAccountModal(),t.$socket.emit("accountEvent"),t.$router.push("/admin/contacts")}))["catch"]((function(o){t.login.loading=!1,t.ajaxErrorHandler(o,(function(o){var s=o.path;void 0!==t.signup.errors[s]&&void 0!==t.signup.errors[s]&&(t.signup.errors[s]=o.message)}))}))):this.login.errors.username="Username must not be blank"}},created:function(){var t=this;this.axios.get("/api/v1/settings").then((function(o){t.$store.commit("setSettings",o.data),t.$store.dispatch("setTitle",t.$store.state.meta.title)}))["catch"]((function(o){t.ajaxErrorHandler(o)})),this.axios.get("/api/v1/category").then((function(o){if(t.$store.commit("addCategories",o.data),!t.$store.state.meta.title.length&&t.$route.params.category){var s=t.$route.params.category.toUpperCase(),n=t.categories.find((function(t){return t.value===s}));t.$store.dispatch("setTitle",n.name)}}))["catch"](this.ajaxErrorHandler)},watch:{$route:function(){this.showMenu=!1},"$store.state.ajaxErrorsModal":function(t){t&&this.$refs.ajaxErrorsModalButton.focus()}}},p=g,f=(s("efa9"),s("2877")),w=Object(f["a"])(p,a,i,!1,null,null,null),v=w.exports,_={name:"Admin",components:{AdminNav:v},data:function(){return{selected:null,routes:[{title:"Обратная связь",route:"contacts",description:"Сообщения оставленные в контактной форме",icon:"home"},{title:"Пользователи",route:"users",description:"Пользователи в системе",icon:"user-circle"}]}},watch:{$route:function(t){this.selected=t.path.split("/")[2]}},created:function(){var t=this;this.selected=this.$route.path.split("/")[2],this.$nextTick((function(){t.$store.state.admin||(t.$router.push("/"),t.$store.commit("setAccountTabs",1),t.$store.commit("setAccountModalState",!0))}))}},$=_,b=(s("70b1"),Object(f["a"])($,n,e,!1,null,"614e36a2",null));o["default"]=b.exports},efa9:function(t,o,s){"use strict";var n=s("5da9"),e=s.n(n);e.a}}]);
//# sourceMappingURL=chunk-364f1b63.2bdf4692.js.map